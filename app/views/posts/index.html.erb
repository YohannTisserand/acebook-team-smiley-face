<% if !@user %>

<%= link_to signup_path do %>
  Sign Up
  <% end %>

<% else %>


<div class="new-post">
<%= form_with model: @post do |form| %>
  <%= form.text_field :message, :placeholder => "What's on your mind?" %>
  <br>
  <%= form.file_field :picture %>
  <%= form.submit "Submit" %>
<% end %>

  </div>
    <% @posts.each do |post| %>
      <div class="post">
      <strong><%= post.message %></strong>
      <% if post.picture.attached? %>
        <%= image_tag(url_for(post.picture), class: "post-picture") %>
      <% end %>
      <p class="posted-at">Posted <%= time_ago_in_words(post.created_at) %> ago</p>
      <p class="posted-by">Posted by <%= post.user.first_name %></p>
        <% if post.user == current_user %>
          <%= button_to "delete post", post, :method => "delete" %>
        <% end %>
        <%= button_to 'Like', post_likes_path(post), :method => "post" %>
        <p><%= post.likes.count %> <%= (post.likes.count) == 1 ? 'Like' : 'Likes'%></p>
        <% if post.comments %>
          <strong>Comments</strong>
          <% post.comments.each do |comment| %>
            <p><%= comment.user.first_name %>: <%= comment.content %></p>
              <% if comment.user == current_user %>
                <%= button_to "delete comment", post_comment_path(post, comment), :method => "delete" %>
              <% end %>
          <% end %>
        <% end %>
      <%= form_with model: [post, post.comments.new] do |f| %>
        <%= f.text_field :content, placeholder: 'Add a comment...' %>
      <% end %>
  </div>
    <% end %>

<% end %>
